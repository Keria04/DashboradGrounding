# 📋  测试指南

**测试目标**: 验证模型实际检测效果，发现需要改进的问题  
**模型版本**: YOLOv8s Phase 1 改进版  
**模型性能**: mAP50 = 51.2%, Recall = 55.7%

---

## 🎯 测试重点说明

我们的模型在不同类型的图表上表现差异很大：
- ✅ **表现优秀**：Map (95%), Bar chart (85%), Bubble chart (99%)
- ⚠️ **表现一般**：Line chart (32%), Heatmap (22%), Scatter plot (38%)
- 🔴 **需要改进**：Pie chart (10%), Radar chart (10%)

---

## 📊 分类测试任务（按优先级）

### 🔥 Priority 1：困难类别测试（最重要）

这些类别训练样本少，急需测试验证：

#### 测试1：Line chart（折线图）⭐⭐⭐⭐⭐

**训练数据**: 只有17个样本  
**预估性能**: mAP ~32%（容易漏检）  
**测试目标**: 验证细线条是否能检测

**测试要求**：
- [ ] 上传至少**3张**包含折线图的仪表盘
- [ ] 测试不同样式：
  - [ ] 单条折线
  - [ ] 多条折线重叠
  - [ ] 细线条（线宽<2px）
  - [ ] 粗线条（线宽>3px）
  - [ ] 带标记点的折线
  - [ ] 平滑曲线 vs 折线

**检测参数建议**：
```
置信度阈值: 0.05（比默认0.10更低）
IoU阈值: 0.35
```

**记录内容**：
```
图像: ____________
折线图数量: ____个
检测到: ____个
漏检: ____个
误检为其他类别: ____（如果有，写是什么）
置信度范围: ____%~____%
```

**关键问题**：
- 细线条能否检测到？
- 多条折线是否都能识别？
- 是否误检为Area chart（面积图）？

---

#### 测试2：Heatmap（热力图）⭐⭐⭐⭐⭐

**训练数据**: 只有5个样本  
**预估性能**: mAP ~22%（最困难）  
**测试目标**: 验证颜色块识别能力

**测试要求**：
- [ ] 上传至少**2张**包含热力图的仪表盘
- [ ] 测试不同样式：
  - [ ] 不同颜色方案（红绿、蓝黄等）
  - [ ] 稀疏 vs 密集热力图
  - [ ] 带数值标注的热力图
  - [ ] 不同大小的热力图

**检测参数建议**：
```
置信度阈值: 0.05（必须降低）
IoU阈值: 0.35
```

**记录内容**：
```
图像: ____________
热力图数量: ____个
检测到: ____个
漏检: ____个
误检为Data table: ____个（热力图容易与表格混淆）
置信度: ____%
```

**关键问题**：
- 能否与Data table区分？
- 颜色块是否被识别？
- 小尺寸热力图能否检测？

---

#### 测试3：Scatter plot（散点图）⭐⭐⭐⭐

**训练数据**: 11个样本  
**预估性能**: mAP ~38%  
**测试目标**: 验证离散点检测

**测试要求**：
- [ ] 上传至少**2张**包含散点图的仪表盘
- [ ] 测试：
  - [ ] 点密集的散点图
  - [ ] 点稀疏的散点图
  - [ ] 不同点大小
  - [ ] 多组散点

**检测参数**：
```
置信度: 0.08
```

**记录**：
```
检测准确率: ____%
主要问题: ____________
```

---

#### 测试4：Pie chart（饼图）⭐⭐⭐⭐

**训练数据**: 只有1个样本  
**预估性能**: mAP ~5-10%（几乎不能检测）  
**测试目标**: 验证是否完全失败

**测试要求**：
- [ ] 上传至少**2张**包含饼图的仪表盘
- [ ] 降低置信度到**0.03**

**预期结果**：很可能检测不到

**记录**：
```
是否检测到: 是 / 否
如果检测到，置信度: ____%
```

---

#### 测试5：Radar chart（雷达图）⭐⭐⭐⭐

**训练数据**: 只有1个样本  
**测试要求**: 同Pie chart

---

### 🟢 Priority 2：优势类别验证（验证稳定性）

这些类别应该检测很好，测试是否稳定：

#### 测试6：Bar chart（柱状图）

**预估性能**: mAP ~85%（应该很好）  
**测试目标**: 验证是否真的优秀

**测试要求**：
- [ ] 上传**2张**包含多个柱状图的仪表盘
- [ ] 使用默认参数（置信度0.10）

**期望**：
- ✅ 所有柱状图都应该被检测到
- ✅ 置信度应该>60%
- ✅ 边界框应该准确

**如果失败**：
```
记录具体问题:
- 哪种柱状图漏检了？（横向/竖向/堆叠等）
- 置信度是否偏低？
```

---

#### 测试7：Map（地图）

**预估性能**: mAP ~95%（最好）  
**测试目标**: 验证最优类别

**测试要求**：
- [ ] 上传**1张**包含地图的仪表盘
- [ ] 使用默认参数

**期望**：
- ✅ 100%检测成功
- ✅ 置信度>80%

---

#### 测试8：Card（卡片）

**预估性能**: mAP ~60%，但召回率低(55.7%)  
**测试目标**: 验证是否存在大量漏检

**测试要求**：
- [ ] 上传**1张**包含大量Card（>5个）的仪表盘

**关键观察**：
```
Card总数: ____个
检测到: ____个
漏检率: ____%（漏检数/总数）
```

**如果漏检率>40%**：
- 尝试降低置信度到0.05
- 记录哪些类型的Card容易漏检（数字卡/文字卡/图标卡）

---

### 🟡 Priority 3：混淆测试（发现误检）

测试模型是否会把A误检为B：

#### 测试9：Area chart vs Line chart

**问题**: 这两类容易混淆

**测试要求**：
- [ ] 上传**1张**同时包含Area chart和Line chart的仪表盘

**观察**：
```
是否正确区分: 是 / 否
误检情况: ____________
```

**如果混淆**：
- 记录具体是哪个被误检了
- 截图保存

---

#### 测试10：Heatmap vs Data table

**问题**: 热力图容易被误检为数据表

**测试要求**：
- [ ] 上传**1张**同时包含两者的仪表盘

---

### ⚙️ Priority 4：参数敏感性测试

测试不同参数对结果的影响：

#### 测试11：置信度阈值影响

**测试要求**：
- [ ] 选择**1张**复杂仪表盘（包含5+个图表）
- [ ] 用不同置信度测试**3次**：
  - 置信度 = 0.25（高）
  - 置信度 = 0.10（默认）
  - 置信度 = 0.05（低）

**记录对比**：
```
置信度0.25: 检测到___个图表
置信度0.10: 检测到___个图表
置信度0.05: 检测到___个图表

观察: 
- 降低阈值是否增加检测数量？
- 是否出现误检？
- 最佳阈值是多少？
```

---

## 📝 测试记录表格

### 总体测试记录表

| 测试项 | 图表类型 | 图表数 | 检测到 | 漏检 | 误检 | 置信度 | 评价 |
|--------|---------|-------|--------|------|------|--------|------|
| 测试1 | Line chart | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试2 | Heatmap | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试3 | Scatter plot | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试4 | Pie chart | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试5 | Radar chart | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试6 | Bar chart | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试7 | Map | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试8 | Card | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试9 | Area vs Line | ? | ? | ? | ? | ? | 满意/一般/差 |
| 测试10 | Heatmap vs Table | ? | ? | ? | ? | ? | 满意/一般/差 |

---

## 🎯 重点关注的问题

### 问题1：漏检（False Negative）

**定义**: 图像中有某类图表，但模型没有检测到

**重点观察**：
- Line chart的漏检率（预计会比较高）
- Heatmap的漏检率（预计很高）
- Card的漏检率（样本多但召回率低）

**记录方式**：
```
图表类型: ____________
漏检原因分析:
□ 图表太小
□ 颜色与背景接近
□ 边界不清晰
□ 与其他图表重叠
□ 其他: ____________
```

---

### 问题2：误检（False Positive）

**定义**: 模型检测到了不存在的图表，或把A误检为B

**重点观察**：
- Line chart是否被误检为Area chart
- Heatmap是否被误检为Data table
- 背景区域是否被误检为Card

**记录方式**：
```
误检情况:
检测为: ____________
实际是: ____________（或不存在）
```

---

### 问题3：定位不准（Localization Error）

**定义**: 检测到了图表，但边界框位置不准确

**观察**：
- 边界框是否框住了完整图表？
- 是否框多了（包含周围空白）？
- 是否框少了（只框了一部分）？

**记录**：
```
定位问题:
□ 框太大（包含多余区域）
□ 框太小（遗漏部分内容）
□ 位置偏移
□ 其他: ____________
```

---

### 问题4：置信度异常

**观察**: 正确检测但置信度很低（<30%）

**重点**：
- Line chart的置信度（预计偏低）
- Heatmap的置信度（预计很低）

**记录**：
```
图表类型: ____________
检测正确: 是
置信度: ___% （如果<30%需记录）
```

---

## 🧪 测试场景设计

### 场景1：单一类型密集测试

**目的**: 测试模型在单一类型大量出现时的表现

**操作**：
- 上传只包含一种图表的仪表盘（如：5个Bar chart）
- 观察是否全部检测到
- 重点测试：Line chart, Heatmap, Card

**期望**：
- Bar chart: 100%检测率 ✅
- Line chart: 60-80%检测率 ⚠️
- Heatmap: 40-60%检测率 🔴

---

### 场景2：混合类型测试

**目的**: 测试复杂场景下的检测能力

**操作**：
- 上传包含5+种不同图表的复杂仪表盘
- 观察整体检测率
- 记录哪些被漏检

**关键指标**：
```
总图表数: ____
检测到: ____
总体检测率: ____%

如果<80%，记录主要漏检的类型
```

---

### 场景3：边界情况测试

**目的**: 测试极端情况

**测试内容**：
- [ ] 非常小的图表（占图像<5%）
- [ ] 非常大的图表（占图像>50%）
- [ ] 图表相互重叠
- [ ] 图表在边缘位置
- [ ] 低对比度图表（颜色与背景接近）

**记录**：
```
哪些边界情况失败了: ____________
```

---

### 场景4：真实业务场景测试

**目的**: 模拟实际使用

**操作**：
- 使用真实的业务仪表盘截图
- 不做任何预处理
- 使用默认参数

**评估标准**：
```
实用性评分（1-5分）:
1分 - 完全不能用
2分 - 勉强能用，漏检很多
3分 - 基本可用，部分漏检
4分 - 效果不错，偶尔漏检
5分 - 效果优秀，几乎不漏检

您的评分: ___分
```

---

## 📋 标准测试流程

### 每个图像的测试步骤

1. **上传图像**
2. **设置参数**（按测试要求）
3. **点击检测**
4. **记录结果**：
   ```
   ✅ 检测成功的图表: ____________
   ❌ 漏检的图表: ____________
   ⚠️ 误检的内容: ____________
   📊 置信度范围: ____%~____%
   ```
5. **截图保存**（特别是失败案例）
6. **填写问题分析**

---

## 🎯 测试数据收集表

### 测试汇总表

| 类别 | 测试图像数 | 图表总数 | 检测到 | 检测率 | 平均置信度 | 评价 |
|------|----------|---------|--------|--------|-----------|------|
| Line chart | ___ | ___ | ___ | ___% | ___% | ___ |
| Heatmap | ___ | ___ | ___ | ___% | ___% | ___ |
| Scatter plot | ___ | ___ | ___ | ___% | ___% | ___ |
| Pie chart | ___ | ___ | ___ | ___% | ___% | ___ |
| Radar chart | ___ | ___ | ___ | ___% | ___% | ___ |
| Bar chart | ___ | ___ | ___ | ___% | ___% | ___ |
| Map | ___ | ___ | ___ | ___% | ___% | ___ |
| Card | ___ | ___ | ___ | ___% | ___% | ___ |
| Area chart | ___ | ___ | ___ | ___% | ___% | ___ |
| Data table | ___ | ___ | ___ | ___% | ___% | ___ |
| Donut chart | ___ | ___ | ___ | ___% | ___% | ___ |
| **整体** | ___ | ___ | ___ | ___% | ___% | ___ |

---

## 🔍 失败案例收集（非常重要！）

### 失败案例记录模板

对于每个失败的检测，请详细记录：

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
失败案例 #___

图像名称: ________________________
失败类型: □ 漏检  □ 误检  □ 定位不准

详细描述:
  应该检测到: ____________（类型）
  实际检测为: ____________（类型，如果误检）
  未检测到: ____________（如果漏检）
  
图表特征:
  位置: □ 左上 □ 右上 □ 左下 □ 右下 □ 中间
  大小: □ 很小(<5%) □ 小(5-15%) □ 中(15-30%) □ 大(>30%)
  颜色: □ 鲜艳 □ 暗淡 □ 与背景接近
  
可能原因（勾选）:
  □ 图表太小
  □ 边界不清晰
  □ 颜色对比度低
  □ 样本训练不足
  □ 与其他图表重叠
  □ 其他: ____________

建议改进:
  ____________________________________________

截图: 已保存 / 未保存

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**请至少收集5个典型失败案例！**

---

## 📊 测试目标（量化指标）

### 最低要求

- [ ] 至少测试**15张**不同的仪表盘图像
- [ ] 覆盖至少**10种**图表类型
- [ ] 收集至少**5个**失败案例
- [ ] 填写完整的测试汇总表

### 推荐目标

- [ ] 测试**30张**图像
- [ ] 覆盖全部**20种**图表类型
- [ ] 收集**10+个**失败案例
- [ ] 提供改进建议

---

